<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><title>Troubleshooting - Fish Feeder</title><link rel="stylesheet" href="css/styles.css"><style>.details-section{border:2px solid #1a5c7a;margin:16px 0;background:#fff}.details-header{background:#1a5c7a;color:#fff;padding:12px;font-weight:700;font-size:1.1em}.details-content{padding:16px;border:2px solid #1a5c7a;margin:0}.detail-row{margin:8px 0;font-size:1em}.detail-label{font-weight:700}.download-btn{background:#1a5c7a;color:#fff;padding:10px 24px;border:none;cursor:pointer;font-size:1em;font-weight:700;margin-top:16px}.download-btn:hover{background:#155068}</style></head><body><script>function loadSystemData(){fetch("/api/system/memory").then(t=>t.json()).then(t=>{t=Math.round(t.free_memory/1024);document.getElementById("freeMemory").textContent=t+"KB"}).catch(()=>{document.getElementById("freeMemory").textContent="N/A"}),fetch("/api/system/uptime").then(t=>t.json()).then(t=>{var e=Math.floor(t.uptime/3600),t=Math.floor(t.uptime%3600/60);document.getElementById("systemUptime").textContent=e+" hours "+t+" min"}).catch(()=>{document.getElementById("systemUptime").textContent="N/A"})}function loadNtfyChannel(){fetch("/api/config").then(t=>t.json()).then(t=>{document.getElementById("ntfyChannel").textContent=t.ntfy_topic||"N/A"}).catch(()=>{document.getElementById("ntfyChannel").textContent="N/A"})}function loadMotorSettings(){fetch("/api/calibration").then(t=>t.json()).then(t=>{document.getElementById("dutyCycle").textContent=t.duty_cycle||"N/A",document.getElementById("pulseWidth").textContent=(t.pulse_duration||"N/A")+"ms"}).catch(()=>{document.getElementById("dutyCycle").textContent="N/A",document.getElementById("pulseWidth").textContent="N/A"})}function downloadLog(){fetch("/api/events").then(t=>t.json()).then(t=>{let o="Timestamp,Event Type,Details\n";t.events&&0<t.events.length?t.events.forEach(t=>{var e=t.timestamp||"",n=t.event_type||"",t=(t.details||"").replace(/,/g,";");o+=e+","+n+","+t+"\n"}):o+="No events found\n";var t=new Blob([o],{type:"text/csv"}),t=window.URL.createObjectURL(t),e=document.createElement("a");e.href=t,e.download="feeder_log_"+(new Date).toISOString().split("T")[0]+".csv",document.body.appendChild(e),e.click(),document.body.removeChild(e),window.URL.revokeObjectURL(t)}).catch(t=>{alert("Failed to download log: "+t.message)})}window.addEventListener("DOMContentLoaded",function(){loadSystemData(),loadMotorSettings(),loadNtfyChannel(),setInterval(loadSystemData,3e4)})</script><div class="header"><div class="header-content"><div class="header-logo"><img src="assets/images/Header.png" alt="Fish Feeder Logo"></div><div class="header-title"><h1>Keep your Fish full</h1></div></div></div><div style="display:flex"><div class="sidebar"><b>Quick Links</b><br><a href="index.html" class="quick-link">Home</a> <a href="setschedule.html" class="quick-link">Set Feeding Schedule</a> <a href="feednow.html" class="quick-link">Feed Now !!!</a> <a href="setquantity.html" class="quick-link">Set Quantity</a> <a href="calibration.html" class="quick-link">Calibration</a> <a href="troubleshooting.html" class="quick-link">Troubleshooting</a></div><div style="flex:1;padding:8px"><h2 style="margin-top:8px">Troubleshooting Details</h2><div class="details-section"><div class="details-header">System details:</div><div class="details-content"><div class="detail-row"><span class="detail-label">Free memory:</span> <span id="freeMemory">Loading...</span></div><div class="detail-row"><span class="detail-label">System Up time:</span> <span id="systemUptime">Loading...</span></div><div class="detail-row"><span class="detail-label">Ntfy Channel Name:</span> <span id="ntfyChannel">Loading...</span></div></div></div><div class="details-section"><div class="details-header">Motor details:</div><div class="details-content"><div class="detail-row"><span class="detail-label">Duty Cycle:</span> <span id="dutyCycle">Loading...</span></div><div class="detail-row"><span class="detail-label">Pulse Width:</span> <span id="pulseWidth">Loading...</span></div></div></div><button class="download-btn" onclick="downloadLog()">Download Log</button></div></div></body></html>