<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>Set Quantity</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="header">
    <div class="header-content">
      <div class="header-logo">
        <img src="assets/images/Header.png" alt="Fish Feeder Logo">
      </div>
      <div class="header-title">
        <h1>Keep your Fish full</h1>
      </div>
    </div>
  </div>
  <div style="display:flex;">
    <div class="sidebar">
  <b>Quick Links</b><br>
  <a href="index.html" class="quick-link">Home</a>
  <a href="setschedule.html" class="quick-link">Set Feeding Schedule</a>
  <a href="feednow.html" class="quick-link">Feed Now !!!</a>
  <a href="setquantity.html" class="quick-link">Set Quantity</a>
  <a href="calibration.html" class="quick-link">Calibration</a>
  <a href="motor_setup.html" class="quick-link">Motor Setup</a>
    </div>
    <div style="flex:1; padding:16px;">
      <div class="card">
        <div style="background:#17688a; color:#fff; padding:8px; font-weight:bold;">Set Quantity</div>
        <form>
          <div style="margin-top:12px; display:flex; align-items:center;">
            <label style="font-weight:bold; margin-right:8px;">Set Remaining Quantity :</label>
            <select id="quantity" style="width:48px;">
              <option value="">&#9660;</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
              <option value="15">15</option>
            </select>
          </div>
          <div style="margin-top:24px;">
            <button type="submit" class="btn">Save</button>
            <button type="button" class="btn" style="background:#17688a; margin-left:8px;">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script>
document.addEventListener('DOMContentLoaded', function() {
  // Load current quantity
  fetch('/api/quantity')
    .then(r => r.json())
    .then(data => {
      if (typeof data.quantity === 'number') {
        document.getElementById('quantity').value = data.quantity;
      }
    });

  // Handle save
  document.querySelector('form').addEventListener('submit', function(e) {
    e.preventDefault();
    const value = document.getElementById('quantity').value;
    fetch('/api/quantity', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ quantity: Number(value) })
    })
    .then(r => r.json())
    .then(data => {
      if (data.status === 'ok') {
        alert('Quantity saved!');
      } else {
        alert('Error saving quantity');
      }
    })
    .catch(() => alert('Error saving quantity'));
  });
});
</script>
</body>
</html>
